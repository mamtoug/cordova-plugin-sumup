<?xml version="1.0" encoding="UTF-8"?>
<plugin xmlns="http://cordova.apache.org/ns/plugins/1.0"
        id="cordova-sumup-plugin"
        version="2.0.0">
    <name>SumUp</name>
    <author>mamtoug</author>
    <description>
        Cordova plugin for SumUp SDK integration (Android-only)
    </description>
    <license>MIT</license>
    <repo>https://github.com/mamtoug/cordova-plugin-sumup.git</repo>
    <issue>https://github.com/mamtoug/cordova-plugin-sumup/issues</issue>
    <keywords>
        sumup, creditcard, debitcard, nfc, card, terminal, pay
    </keywords>

    <engines>
        <engine name="cordova-android" version=">=6.3.0" />
    </engines>

    <js-module src="www/sumup.js" name="SumUp">
        <clobbers target="window.SumUp"/>
    </js-module>

    <!-- Android Only -->
    <platform name="android">
        <preference name="SUMUP_API_KEY" />

        <config-file target="res/xml/config.xml" parent="/*">
            <feature name="SumUp">
                <param name="android-package" value="de.mamtoug.cordova.sumup.SumUp" />
            </feature>
        </config-file>

        <config-file target="res/values/strings.xml" parent="/resources">
            <string name="SUMUP_API_KEY">$SUMUP_API_KEY</string>
        </config-file>

        <source-file src="src/android/SumUp.java" target-dir="src/de/mamtoug/cordova/sumup" />

        <config-file target="AndroidManifest.xml" parent="/*">
            <!-- Network permissions -->
            <uses-permission android:name="android.permission.INTERNET" />
            <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
            <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />

            <!-- Bluetooth permissions -->
            <uses-permission android:name="android.permission.BLUETOOTH" />
            <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" />
            <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />
            <uses-permission android:name="android.permission.BLUETOOTH_SCAN" />

            <!-- Location permissions -->
            <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
            <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

            <!-- NFC permissions -->
            <uses-permission android:name="android.permission.NFC" />

            <!-- Camera permissions -->
            <uses-permission android:name="android.permission.CAMERA" />

            <!-- Optional features -->
            <uses-feature android:name="android.hardware.bluetooth" android:required="false" />
            <uses-feature android:name="android.hardware.bluetooth_le" android:required="false" />
            <uses-feature android:name="android.hardware.nfc" android:required="false" />
            <uses-feature android:name="android.hardware.camera" android:required="false" />
            <uses-feature android:name="android.hardware.camera.autofocus" android:required="false" />
        </config-file>

        <!-- SumUp SDK Dependency -->
        <framework src="com.sumup:merchant-sdk:5.0.2" />

        <!-- Repository for SumUp SDK -->
        <config-file target="repositories.gradle" parent="repositories">
            <maven>
                <url>https://maven.sumup.com/releases</url>
            </maven>
        </config-file>

        <!-- Custom Gradle File -->
        <framework src="src/android/build.gradle" custom="true" type="gradleReference" />
    </platform>
</plugin>
